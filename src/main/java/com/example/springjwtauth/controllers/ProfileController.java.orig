package com.example.springjwtauth.controllers;


import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
@RequestMapping("/api/profile")
public class ProfileController {
<<<<<<< HEAD

    @Autowired
    private ProfileRepository repository;


    @GetMapping("/all")
    @ResponseBody
    public List<Profile> getEveryone() {
        return repository.findAll();
    }

    @PostMapping("/create")
    public ResponseEntity<Profile> createProfile(@RequestBody Profile newProfile) {
        return new ResponseEntity<>(repository.save(newProfile), HttpStatus.CREATED);
    }

    @PutMapping("/{id}")
    @ResponseBody
    public Profile updateProfile(@PathVariable Long id, @RequestBody Profile updates) {
        Profile profile = repository.findById(id).orElseThrow(() -> new ResponseStatusException(HttpStatus.NOT_FOUND));

        if (updates.getfName() != null) profile.setfName(updates.getfName());
        if (updates.getlName() != null) profile.setlName(updates.getlName());
        if (updates.getTitle() != null) profile.setTitle(updates.getTitle());
        if (updates.getAge() != profile.getAge()) profile.setAge(updates.getAge());
        if (updates.getBio() != null) profile.setBio(updates.getBio());
        if (updates.getRole() != null) profile.setRole(updates.getRole());

        return repository.save(profile);
    }

    @DeleteMapping("/{id}")
    public ResponseEntity<String> removeProfile(@PathVariable Long id){
        repository.deleteById(id);
        return new ResponseEntity<>("Deleted", HttpStatus.OK);
    }
    @DeleteMapping
    public ResponseEntity<String> destroyDeveloper() {
        User currentUser = userService.getCurrentUser();

        if (currentUser == null) {
            return null;
        }
        repository.deleteByUser_id(currentUser.getId());
        return new ResponseEntity<>("Deleted", HttpStatus.OK);
    }

=======
>>>>>>> main
}
